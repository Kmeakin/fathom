Program {
    defs: {
        Path {
            base: "DisplayParams",
            children: []
        }: Struct(
            "",
            [
                Field {
                    doc: "Video input parameters bitmap",
                    name: "input_flags",
                    value: Const(
                        Unsigned(
                            U8
                        )
                    )
                },
                Field {
                    doc: "Maximum horizontal image size, in centimetres (max 292 cm/115 in at\n16:9 aspect ratio)",
                    name: "screen_size_h",
                    value: Const(
                        Unsigned(
                            U8
                        )
                    )
                },
                Field {
                    doc: "Maximum vertical image size, in centimetres. If either byte is 0,\nundefined (e.g. projector)",
                    name: "screen_size_v",
                    value: Const(
                        Unsigned(
                            U8
                        )
                    )
                },
                Field {
                    doc: "Display gamma data, factory default (range 1.00–3.54), where\n`gamma_mod = (gamma×100)-100 = (gamma−1)×100` If 225, gamma is defined\nby DI-EXT block.",
                    name: "gamma_mod",
                    value: Const(
                        Unsigned(
                            U8
                        )
                    )
                },
                Field {
                    doc: "Display gamma, derived from `gamma_mod`",
                    name: "gamma",
                    value: Const(
                        Float(
                            F32
                        )
                    )
                },
                Field {
                    doc: "Supported features bitmap",
                    name: "features_flags",
                    value: Const(
                        Unsigned(
                            U8
                        )
                    )
                }
            ],
            Some(
                Sequence(
                    [
                        Named("input_flags", Const(
                            U8
                        )),
                        Named("screen_size_h", Const(
                            U8
                        )),
                        Named("screen_size_v", Const(
                            U8
                        )),
                        Named("gamma_mod", Const(
                            U8
                        )),
                        Named("gamma", Compute(
                            Binop(
                                Div,
                                Binop(
                                    Add,
                                    Cast(
                                        Var(
                                            Bound(Named("gamma_mod", BoundVar(0, 0)))
                                        ),
                                        Const(
                                            Float(
                                                F32
                                            )
                                        )
                                    ),
                                    Const(
                                        Float(100, F32)
                                    )
                                ),
                                Const(
                                    Float(100, F32)
                                )
                            )
                        )),
                        Named("features_flags", Const(
                            U8
                        ))
                    ],
                    Struct(
                        Path {
                            base: "DisplayParams",
                            children: []
                        },
                        [
                            Field {
                                doc: "Video input parameters bitmap",
                                name: "input_flags",
                                value: Var(
                                    Bound(Named("input_flags", BoundVar(5, 0)))
                                )
                            },
                            Field {
                                doc: "Maximum horizontal image size, in centimetres (max 292 cm/115 in at\n16:9 aspect ratio)",
                                name: "screen_size_h",
                                value: Var(
                                    Bound(Named("screen_size_h", BoundVar(4, 0)))
                                )
                            },
                            Field {
                                doc: "Maximum vertical image size, in centimetres. If either byte is 0,\nundefined (e.g. projector)",
                                name: "screen_size_v",
                                value: Var(
                                    Bound(Named("screen_size_v", BoundVar(3, 0)))
                                )
                            },
                            Field {
                                doc: "Display gamma data, factory default (range 1.00–3.54), where\n`gamma_mod = (gamma×100)-100 = (gamma−1)×100` If 225, gamma is defined\nby DI-EXT block.",
                                name: "gamma_mod",
                                value: Var(
                                    Bound(Named("gamma_mod", BoundVar(2, 0)))
                                )
                            },
                            Field {
                                doc: "Display gamma, derived from `gamma_mod`",
                                name: "gamma",
                                value: Var(
                                    Bound(Named("gamma", BoundVar(1, 0)))
                                )
                            },
                            Field {
                                doc: "Supported features bitmap",
                                name: "features_flags",
                                value: Var(
                                    Bound(Named("features_flags", BoundVar(0, 0)))
                                )
                            }
                        ]
                    )
                )
            )
        ),
        Path {
            base: "Edid",
            children: []
        }: Struct(
            "https://en.wikipedia.org/wiki/Extended_Display_Identification_Data",
            [
                Field {
                    doc: "Header information",
                    name: "header",
                    value: Path(
                        Path {
                            base: "Header",
                            children: []
                        }
                    )
                },
                Field {
                    doc: "Basic display parameters",
                    name: "display_params",
                    value: Path(
                        Path {
                            base: "DisplayParams",
                            children: []
                        }
                    )
                }
            ],
            Some(
                Sequence(
                    [
                        Named("header", Var(
                            Bound(Named("Header", BoundVar(1, 0)))
                        )),
                        Named("display_params", Var(
                            Bound(Named("DisplayParams", BoundVar(1, 0)))
                        ))
                    ],
                    Struct(
                        Path {
                            base: "Edid",
                            children: []
                        },
                        [
                            Field {
                                doc: "Header information",
                                name: "header",
                                value: Var(
                                    Bound(Named("header", BoundVar(1, 0)))
                                )
                            },
                            Field {
                                doc: "Basic display parameters",
                                name: "display_params",
                                value: Var(
                                    Bound(Named("display_params", BoundVar(0, 0)))
                                )
                            }
                        ]
                    )
                )
            )
        ),
        Path {
            base: "Header",
            children: []
        }: Struct(
            "",
            [
                Field {
                    doc: "Fixed header pattern",
                    name: "magic",
                    value: Const(
                        Unsigned(
                            U64
                        )
                    )
                },
                Field {
                    doc: "Manufacturer ID",
                    name: "mfg_bytes",
                    value: Const(
                        Unsigned(
                            U16
                        )
                    )
                },
                Field {
                    doc: "Manufacturer product code",
                    name: "product_code",
                    value: Const(
                        Unsigned(
                            U16
                        )
                    )
                },
                Field {
                    doc: "Serial number",
                    name: "serial",
                    value: Const(
                        Unsigned(
                            U32
                        )
                    )
                },
                Field {
                    doc: "Week of manufacture. Week numbering is not consistent between manufacturers.",
                    name: "mfg_week",
                    value: Const(
                        Unsigned(
                            U8
                        )
                    )
                },
                Field {
                    doc: "Year of manufacture, less 1990. (1990–2245). If week=255, it is the model year instead.",
                    name: "mfg_year_mod",
                    value: Const(
                        Unsigned(
                            U8
                        )
                    )
                },
                Field {
                    doc: "Year of manufacture, derived from `mfg_year_mod`",
                    name: "mfg_year",
                    value: Const(
                        Unsigned(
                            U16
                        )
                    )
                },
                Field {
                    doc: "EDID version, usually 1 (for 1.3)",
                    name: "edid_version_major",
                    value: Const(
                        Unsigned(
                            U8
                        )
                    )
                },
                Field {
                    doc: "EDID revision, usually 3 (for 1.3)",
                    name: "edid_version_minor",
                    value: Const(
                        Unsigned(
                            U8
                        )
                    )
                }
            ],
            Some(
                Sequence(
                    [
                        Named("magic", Assert(
                            Const(
                                U64Le
                            ),
                            Abs(
                                [
                                    Named("magic", Const(
                                        Unsigned(
                                            U64
                                        )
                                    ))
                                ],
                                Binop(
                                    Eq,
                                    Var(
                                        Bound(Named("magic", BoundVar(0, 0)))
                                    ),
                                    Const(
                                        Int(72057594037927680, Unsigned(U64))
                                    )
                                )
                            )
                        )),
                        Named("mfg_bytes", Const(
                            U16Le
                        )),
                        Named("product_code", Const(
                            U16Le
                        )),
                        Named("serial", Const(
                            U32Le
                        )),
                        Named("mfg_week", Const(
                            U8
                        )),
                        Named("mfg_year_mod", Const(
                            U8
                        )),
                        Named("mfg_year", Compute(
                            Binop(
                                Add,
                                Cast(
                                    Var(
                                        Bound(Named("mfg_year_mod", BoundVar(0, 0)))
                                    ),
                                    Const(
                                        Unsigned(
                                            U16
                                        )
                                    )
                                ),
                                Const(
                                    Int(1990, Unsigned(U16))
                                )
                            )
                        )),
                        Named("edid_version_major", Const(
                            U8
                        )),
                        Named("edid_version_minor", Const(
                            U8
                        ))
                    ],
                    Struct(
                        Path {
                            base: "Header",
                            children: []
                        },
                        [
                            Field {
                                doc: "Fixed header pattern",
                                name: "magic",
                                value: Var(
                                    Bound(Named("magic", BoundVar(8, 0)))
                                )
                            },
                            Field {
                                doc: "Manufacturer ID",
                                name: "mfg_bytes",
                                value: Var(
                                    Bound(Named("mfg_bytes", BoundVar(7, 0)))
                                )
                            },
                            Field {
                                doc: "Manufacturer product code",
                                name: "product_code",
                                value: Var(
                                    Bound(Named("product_code", BoundVar(6, 0)))
                                )
                            },
                            Field {
                                doc: "Serial number",
                                name: "serial",
                                value: Var(
                                    Bound(Named("serial", BoundVar(5, 0)))
                                )
                            },
                            Field {
                                doc: "Week of manufacture. Week numbering is not consistent between manufacturers.",
                                name: "mfg_week",
                                value: Var(
                                    Bound(Named("mfg_week", BoundVar(4, 0)))
                                )
                            },
                            Field {
                                doc: "Year of manufacture, less 1990. (1990–2245). If week=255, it is the model year instead.",
                                name: "mfg_year_mod",
                                value: Var(
                                    Bound(Named("mfg_year_mod", BoundVar(3, 0)))
                                )
                            },
                            Field {
                                doc: "Year of manufacture, derived from `mfg_year_mod`",
                                name: "mfg_year",
                                value: Var(
                                    Bound(Named("mfg_year", BoundVar(2, 0)))
                                )
                            },
                            Field {
                                doc: "EDID version, usually 1 (for 1.3)",
                                name: "edid_version_major",
                                value: Var(
                                    Bound(Named("edid_version_major", BoundVar(1, 0)))
                                )
                            },
                            Field {
                                doc: "EDID revision, usually 3 (for 1.3)",
                                name: "edid_version_minor",
                                value: Var(
                                    Bound(Named("edid_version_minor", BoundVar(0, 0)))
                                )
                            }
                        ]
                    )
                )
            )
        )
    }
}

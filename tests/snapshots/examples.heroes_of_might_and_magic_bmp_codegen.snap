extern crate ddl_util;

use std::io;
use std::io::prelude::*;

pub struct HerosOfMightAndMagicBmp {
    pub magic: u16,
    pub width: u16,
    pub height: u16,
    pub data: Vec<u8>,
}

impl HerosOfMightAndMagicBmp {
    pub fn read<R: Read>(reader: &mut R) -> io::Result<HerosOfMightAndMagicBmp> {
        let magic = ddl_util::from_u16le(reader)?;
        let width = ddl_util::from_u16le(reader)?;
        let height = ddl_util::from_u16le(reader)?;
        let data =
        (0..(width * height)).map(|_| ddl_util::from_u8(reader)).collect::<Result<_, _>>()?;
        Ok(HerosOfMightAndMagicBmp {
            magic: magic,
            width: width,
            height: height,
            data: data,
        })
    }
}


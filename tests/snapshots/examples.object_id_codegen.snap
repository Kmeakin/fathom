extern crate ddl_util;

use std::io;
use std::io::prelude::*;

pub struct ObjectId {
    pub epoch_time: u32,
    pub machine_id: Vec<u8>,
    pub process_id: u16,
    pub counter: Vec<u8>,
}

impl ObjectId {
    pub fn read<R: Read>(reader: &mut R) -> io::Result<ObjectId> {
        let epoch_time = ddl_util::from_u32le(reader)?;
        let machine_id = (0..3).map(|_| ddl_util::from_u8(reader)).collect::<Result<_, _>>()?;
        let process_id = ddl_util::from_u16le(reader)?;
        let counter = (0..3).map(|_| ddl_util::from_u8(reader)).collect::<Result<_, _>>()?;
        Ok(ObjectId {
            epoch_time: epoch_time,
            machine_id: machine_id,
            process_id: process_id,
            counter: counter,
        })
    }
}

